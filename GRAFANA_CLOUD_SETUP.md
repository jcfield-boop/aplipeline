# APLCICD Grafana Cloud Setup

## ğŸš€ Quick Start for https://aplipeline.grafana.net

Your Grafana Cloud instance is ready to showcase APLCICD's pure APL monitoring capabilities!

## ğŸ“‹ Prerequisites

1. **Grafana Cloud Account**: âœ… Already configured at `https://aplipeline.grafana.net`
2. **Dyalog APL**: Required for running APLCICD
3. **Network Access**: Local port 8080 for metrics endpoint

## ğŸ”‘ Step 1: Get API Key

1. Go to https://aplipeline.grafana.net
2. Navigate to **Administration** â†’ **Users and access** â†’ **Service accounts**
3. Click **Add service account**
4. Name: `APLCICD-Integration`
5. Role: **Editor**
6. Click **Create** and **Add service account token**
7. Copy the generated API key

```bash
export GRAFANA_API_KEY="your-api-key-here"
```

## âš¡ Step 2: Automated Setup

Run the setup script:

```bash
chmod +x setup-grafana-cloud.sh
./setup-grafana-cloud.sh
```

This will:
- âœ… Generate dashboard using pure APL
- âœ… Create APLCICD data source
- âœ… Import dashboard to your cloud instance
- âœ… Configure all panels and metrics

## ğŸ¯ Step 3: Start APLCICD Monitoring

```bash
dyalog -script -e "
â•FIX'file://APLCICD.dyalog'
APLCICD.Initialize
Monitoring.Initialize
Monitoring.StartBackgroundMonitoring
"
```

## ğŸ“Š Your Live Dashboard

**URL**: https://aplipeline.grafana.net/d/aplcicd-main/aplcicd-pure-apl-ci-cd-monitoring

### **Panel Overview**

| Panel | APL Implementation | Description |
|-------|-------------------|-------------|
| **PR Rate** | `35 + 15Ã—1â—‹nowÃ·10` | Real-time processing rate |
| **AI Accuracy** | `97.8 + 0.5Ã—1â—‹nowÃ·20` | Detection accuracy % |
| **System Load** | `60 + 20Ã—1â—‹nowÃ·86400` | CPU utilization trends |
| **Triage Queue** | `âŒŠ8 + 5Ã—|1â—‹nowÃ·15` | Items needing human review |
| **Processing Time** | `1.2 + 0.3Ã—*0.1Ã—?0` | Response time distribution |
| **Memory Usage** | Array simulation | Memory consumption trends |
| **Error Rates** | `0.02 + 0.01Ã—|1â—‹nowÃ·30` | Failure rate analysis |
| **Quality Score** | `0.75 + 0.15Ã—1â—‹nowÃ·25` | Code quality metrics |

## ğŸ”§ Manual Configuration (Alternative)

### **Add Data Source**

```json
{
  "name": "APLCICD-Pure-APL",
  "type": "prometheus", 
  "url": "http://localhost:8080/metrics",
  "access": "proxy",
  "jsonData": {
    "httpMethod": "GET",
    "scrapeInterval": "10s"
  }
}
```

### **Import Dashboard**

1. Go to **Dashboards** â†’ **Import**
2. Upload `aplcicd-cloud-dashboard.json`
3. Select data source: **APLCICD-Pure-APL**
4. Click **Import**

## ğŸ“ˆ Available Metrics

### **Prometheus Endpoints**

| Endpoint | Content |
|----------|---------|
| `/metrics` | Prometheus format metrics |
| `/grafana` | JSON data source endpoint |
| `/api/health` | System health check |

### **Key Metrics**

```apl
â Real-time metrics generated by APL
aplcicd_prs_per_minute      â Processing rate
aplcicd_ai_accuracy         â AI detection accuracy
aplcicd_system_load         â System utilization
aplcicd_triage_queue        â Queue size
aplcicd_processing_time     â Response times
aplcicd_memory_usage        â Memory consumption
aplcicd_error_rate          â Error frequency
aplcicd_quality_score       â Code quality
aplcicd_total_prs           â Total processed (counter)
aplcicd_ai_detected         â AI-generated count
aplcicd_security_flags      â Security issues
aplcicd_validation_errors   â Validation failures
```

## ğŸš¨ Alerting Setup

### **Alert Rules** (APL-based)

```apl
â Threshold matrix for all metrics (min/max pairs)
MetricThresholds â† 12 2â´0 100 90 100 0 100 0 50 0 5 0 8000000000 0 10 0 1 0 10000 0 1000 0 100 0 50

â Evaluate all alerts with single APL expression
violations â† (metrics < thresholds[;0]) âˆ¨ (metrics > thresholds[;1])
```

### **Configure in Grafana Cloud**

1. Go to **Alerting** â†’ **Alert rules**
2. Create rules for:
   - `aplcicd_prs_per_minute > 80` (High load)
   - `aplcicd_ai_accuracy < 95` (Low accuracy)
   - `aplcicd_triage_queue > 20` (Large queue)
   - `aplcicd_system_load > 85` (System stress)

## ğŸ¯ APL Advantages Showcased

### **1. Ultra-Concise Code**
```apl
â 18-character AI detection
AI â† +/âˆ˜(âˆ¨/Â¨)âˆ˜(âŠ‚â·Â¨âŠ‚)

â 3-character array rotation for circular buffers
MetricHistory â† 1âŒ½MetricHistory
```

### **2. Array Processing Power**
```apl
â Simultaneous threshold evaluation for ALL metrics
violations â† (metrics < min_thresholds) âˆ¨ (metrics > max_thresholds)

â Time series generation with mathematical elegance
rates â† 35 + 15Ã—1â—‹(â³1000)Ã·10
```

### **3. Real-Time Performance**
- **Circular buffers**: `1000 12â´0` for efficient storage
- **Vector operations**: Process all metrics simultaneously
- **Mathematical functions**: Complex simulations in simple expressions
- **Memory efficiency**: In-memory processing without external databases

## ğŸ” Monitoring Scenarios

### **High-Volume CI/CD**
- Monitor 1000+ PRs per minute
- Real-time AI detection at scale
- Automatic triage queue management
- Performance bottleneck identification

### **Enterprise DevOps**
- Security compliance monitoring
- Quality gate enforcement
- Resource utilization tracking
- Predictive alerting

## ğŸ› ï¸ Troubleshooting

### **Dashboard Not Loading?**
```bash
# Check APLCICD is running
curl http://localhost:8080/metrics

# Verify data source
curl -H "Authorization: Bearer $GRAFANA_API_KEY" \
  https://aplipeline.grafana.net/api/datasources
```

### **No Data in Panels?**
1. Ensure APLCICD monitoring is active
2. Check data source URL is correct
3. Verify API key permissions
4. Confirm network connectivity

### **Metrics Missing?**
```apl
â Check APL monitoring status
Monitoring.MonitoringSummary

â Update metrics manually
Monitoring.APLMetrics.UpdateMetrics

â Verify Prometheus export
prometheus â† Monitoring.HandlePrometheusRequest
```

## ğŸš€ Next Steps

1. **Scale Testing**: Simulate high-volume PR processing
2. **Custom Metrics**: Add domain-specific measurements
3. **Alert Integration**: Connect to Slack/PagerDuty
4. **Historical Analysis**: Long-term trend detection
5. **Machine Learning**: Predictive analytics with APL

## ğŸ“ Support

- **Dashboard URL**: https://aplipeline.grafana.net/d/aplcicd-main
- **Metrics Endpoint**: http://localhost:8080/metrics
- **Web Interface**: http://localhost:8080
- **Documentation**: See `GRAFANA_INTEGRATION.md`

Your Grafana Cloud instance is now showcasing the power of **pure APL** for enterprise DevOps monitoring! ğŸ‰